<h1 mat-dialog-title class="dialog-title">Summary</h1>
<div mat-dialog-content>
  <p class="disclaimer">
    The below summary was generated by <strong>PokerBot</strong> your AI Scrum
    master. It likes to quote famous people and may produce inaccurate
    information about this planning session.
  </p>
  <div class="summary">
    <div class="summary-response">
      @if (failedPrecondition$ | async; as failedPrecondition) {
      <div class="middle-text">
        @if (failedPrecondition === 'room-size') {
        <h2>Not enough data</h2>
        <p>
          To generate a meaningful summary, you must have at least two rounds
          and another member in this room.
        </p>
        } @if (failedPrecondition === 'user') {
        <h2>No user account</h2>
        <p>
          You need a permanent Planning Poker account to view or generate a
          summary.
        </p>
        } @if ( failedPrecondition === 'credits' && (summaryResponse$ | async)
        === undefined ) {
        <h2>Oops!</h2>
        <p>You are out of your monthly free credits.</p>
        <p>Upgrade to Premium to get unlimited room summaries and much more!</p>
        }
      </div>
      }
      <div class="response-text" id="response-text"></div>
      @if ( (summaryResponse$ | async) === undefined && (failedPrecondition$ |
      async) === undefined ) {
      <div class="loading-blocks">
        <div class="loading-block"></div>
      </div>
      }
    </div>
    <div class="summary-buttons">
      <button
        mat-button
        (click)="generateSummary()"
        [disabled]="!!(failedPrecondition$ | async) || isLoadingResults"
      >
        <mat-icon>refresh</mat-icon>
        Regenerate
      </button>
    </div>
  </div>
  <div mat-dialog-actions>
    <button
      mat-flat-button
      color="primary"
      (click)="copyToClipboard()"
      [disabled]="!(summaryResponse$ | async)?.text?.length"
      cdkFocusInitial
    >
      <mat-icon>content_copy</mat-icon>
      Copy summary
    </button>
    <button mat-button mat-dialog-close>Cancel</button>
  </div>
</div>
