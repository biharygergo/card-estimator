<mat-list>
  <ng-container *ngIf="(room?.rounds)[currentRound].show_results">
    <ng-container *ngIf="roundStatistics[currentRound] as statistics">
      <h3 matSubheader class="subheader">Statistics</h3>
      <mat-list-item>
        <h3 matLine class="statistic">
          <div>Majority</div>
          <div>
            <mat-chip-set>
              <mat-chip
                class="consensus"
                *ngIf="statistics.consensus.isConsensus"
              >
                <span matChipAvatar>ðŸŽ‰</span>
                <strong>Consensus</strong>
              </mat-chip>
              <mat-chip>
                {{
                  statistics.consensus.value
                    | estimateConverter
                      : selectedEstimationCardSetValue
                      : "exact"
                }}
              </mat-chip>
            </mat-chip-set>
          </div>
        </h3>
      </mat-list-item>
      <mat-list-item>
        <h3 matLine class="statistic">
          Average
          <mat-chip-set>
            <mat-chip>
              {{
                statistics.average
                  | number : "1.0-1"
                  | estimateConverter
                    : selectedEstimationCardSetValue
                    : "rounded"
              }}
            </mat-chip>
          </mat-chip-set>
        </h3>
      </mat-list-item>
      <mat-list-item>
        <h3 matLine class="statistic">
          Highest
          <mat-chip-set>
            <mat-chip class="voter">
              {{ statistics.highestVote.voter }}
            </mat-chip>
            <mat-chip>
              {{
                statistics.highestVote.value
                  | estimateConverter : selectedEstimationCardSetValue : "exact"
              }}
            </mat-chip>
          </mat-chip-set>
        </h3>
      </mat-list-item>
      <mat-list-item>
        <h3 matLine class="statistic">
          Lowest
          <mat-chip-set>
            <mat-chip class="voter">
              {{ statistics.lowestVote.voter }}
            </mat-chip>
            <mat-chip>
              {{
                statistics.lowestVote.value
                  | estimateConverter : selectedEstimationCardSetValue : "exact"
              }}
            </mat-chip>
          </mat-chip-set>
        </h3>
      </mat-list-item>
    </ng-container>
  </ng-container>

  <h3 matSubheader class="subheader">Votes</h3>
  <mat-list-item *ngFor="let member of members">
    <span matListItemAvatar class="avatar">
      <img
        *ngIf="member.avatarUrl"
        [src]="member.avatarUrl"
        class="avatar-image"
        alt="A user's avatar"
      />
      <div class="avatar-text" *ngIf="!member.avatarUrl">
        {{ member.name?.charAt(0) }}
      </div>
    </span>
    <h3 matLine class="member">
      <span class="member-name">
        {{ member.name }}
        <mat-icon
          class="verified-icon"
          *ngIf="userProfiles[member.id]"
          [matTooltip]="
            member.name +
            ' is verified. Get your blue checkmark by signing up for a permanent account.'
          "
          >verified</mat-icon
        >
      </span>

      <mat-chip-set>
        <ng-container *ngIf="member.type === MemberType.ESTIMATOR">
          <mat-chip
            class="vote"
            *ngIf="
              (room?.rounds)[currentRound].estimates[member.id] === null &&
              (room?.rounds)[currentRound].show_results
            "
            >Pass</mat-chip
          >
          <mat-chip
            class="vote"
            *ngIf="
              (room?.rounds)[currentRound].estimates[member.id] !== undefined &&
              (room?.rounds)[currentRound].estimates[member.id] !== null &&
              (room?.rounds)[currentRound].show_results
            "
            >{{
              (room?.rounds)[currentRound].estimates[member.id]
                | estimateConverter : selectedEstimationCardSetValue : "exact"
            }}</mat-chip
          >
          <mat-chip
            class="vote"
            *ngIf="
              (room?.rounds)[currentRound].estimates[member.id] === undefined &&
              (room?.rounds)[currentRound].show_results
            "
          >
            Not voted
          </mat-chip>
          <mat-chip
            class="vote"
            *ngIf="
              (room?.rounds)[currentRound].estimates[member.id] === undefined &&
              !(room?.rounds)[currentRound].show_results
            "
          >
            Waiting to vote
          </mat-chip>
          <mat-chip
            class="vote"
            *ngIf="
              (room?.rounds)[currentRound].estimates[member.id] !== undefined &&
              !(room?.rounds)[currentRound].show_results
            "
          >
            Voted
          </mat-chip>
        </ng-container>
        <mat-chip *ngIf="member.type === MemberType.OBSERVER">
          Observing
        </mat-chip>
      </mat-chip-set>
    </h3>
  </mat-list-item>
</mat-list>
